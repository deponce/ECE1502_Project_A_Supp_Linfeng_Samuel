Distributed training:  False
Hyper-parameters:
 {'cfg': '../configs/MNIST/ConvIN/IPC10.yaml', 'dataset': 'MNIST', 'subset': 'imagenette', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_eval': 1, 'eval_it': 500, 'epoch_eval_train': 1000, 'Iteration': 2000, 'lr_img': 100, 'lr_teacher': 0.01, 'lr_init': 0.01, 'batch_real': 256, 'batch_syn': 64, 'batch_train': 64, 'pix_init': 'samples_predicted_correctly', 'dsa': True, 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': '../dataset', 'buffer_path': '../buffer_storage/', 'expert_epochs': 2, 'syn_steps': 80, 'max_start_epoch': 20, 'min_start_epoch': 0, 'zca': True, 'load_all': False, 'no_aug': False, 'texture': False, 'canvas_size': 2, 'canvas_samples': 1, 'max_files': None, 'max_experts': None, 'force_save': False, 'ema_decay': 0.9995, 'lr_y': 2.0, 'Momentum_y': 0.9, 'project': 'MNIST_ipc10', 'name': 'RANDOM', 'threshold': 1.0, 'loss_ratio': 0.5, 'depth_ratio': 0.5, 'record_loss': False, 'Sequential_Generation': True, 'expansion_end_epoch': 1000, 'current_max_start_epoch': 10, 'init_frozen': 'start', 'skip_first_eva': True, 'parall_eva': False, 'lr_lr': 1e-05, 'res': 32, 'device': 'cuda', 'Initialize_Label_With_Another_Model': False, 'Initialize_Label_Model': '', 'Initialize_Label_Model_Dir': '', 'Label_Model_Timestamp': -1, 'zca_trans': ZCAWhitening(), 'im_size': [28, 28], 'dc_aug_param': None, 'dsa_param': <utils.utils_baseline.ParamDiffAug object at 0x7efccdfeb550>, '_wandb': {}, 'distributed': False}
Evaluation model pool:  ['ConvNet']
BUILDING DATASET
  0%|                                                                                                                                             | 0/60000 [00:00<?, ?it/s]/fs2/comm/kpgrp/yelinfen/Documents/ECE1512_2024F_ProjectA_submission_files/PAD-main/distill/PAD_depth.py:116: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels_all.append(class_map[torch.tensor(sample[1]).item()])
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 60000/60000 [00:00<00:00, 81786.35it/s]
60000it [00:00, 1155026.09it/s]
class c = 0: 5923 real images
class c = 1: 6742 real images
class c = 2: 5958 real images
class c = 3: 6131 real images
class c = 4: 5842 real images
class c = 5: 5421 real images
class c = 6: 5918 real images
class c = 7: 6265 real images
class c = 8: 5851 real images
class c = 9: 5949 real images
real images channel 0, mean = -0.0000, std = 0.5891
/fs2/comm/kpgrp/yelinfen/Documents/ECE1512_2024F_ProjectA_submission_files/PAD-main/distill/PAD_depth.py:138: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:278.)
  label_syn = torch.tensor([np.ones(args.ipc) * i for i in range(num_classes)], dtype=torch.long, requires_grad=False,
Expert Dir: ../buffer_storage/MNIST/ConvNet
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
/fs2/comm/kpgrp/yelinfen/Documents/ECE1512_2024F_ProjectA_submission_files/PAD-main/distill/PAD_depth.py:178: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  buffer = torch.load(expert_files[expert_id[file_idx]])
/fs2/comm/kpgrp/yelinfen/Documents/ECE1512_2024F_ProjectA_submission_files/PAD-main/distill/PAD_depth.py:208: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  temp_params = torch.load(label_expert_files[0])[0][args.Label_Model_Timestamp]
0.0.0
1.0.0
2.0.0
3.0.0
4.0.0
5.0.0
6.0.0
7.0.0
8.0.0
9.0.0
[2024-11-04 11:13:15] training begins
/fs2/comm/kpgrp/yelinfen/Documents/ECE1512_2024F_ProjectA_submission_files/PAD-main/distill/PAD_depth.py:292: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  Temp_Buffer = torch.load(label_expert_files[i])
InitialAcc:1.0
/fs2/comm/kpgrp/yelinfen/miniconda3/envs/py310/lib/python3.10/site-packages/torch/functional.py:534: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3595.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
[2024-11-04 11:13:19] iter = 0000, loss = 0.7025
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
/fs2/comm/kpgrp/yelinfen/Documents/ECE1512_2024F_ProjectA_submission_files/PAD-main/distill/PAD_depth.py:506: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  buffer = torch.load(expert_files[expert_id[file_idx]])
[2024-11-04 11:13:38] iter = 0010, loss = 0.5936
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:13:58] iter = 0020, loss = 0.5670
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:14:17] iter = 0030, loss = 0.5564
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:14:37] iter = 0040, loss = 0.3533
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:14:56] iter = 0050, loss = 0.5875
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:15:16] iter = 0060, loss = 0.2942
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:15:36] iter = 0070, loss = 0.2765
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:15:55] iter = 0080, loss = 0.6778
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:16:15] iter = 0090, loss = 0.3132
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:16:34] iter = 0100, loss = 0.3103
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:16:54] iter = 0110, loss = 0.2499
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:17:13] iter = 0120, loss = 0.2793
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:17:33] iter = 0130, loss = 0.2909
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:17:53] iter = 0140, loss = 0.6522
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:18:12] iter = 0150, loss = 0.6073
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:18:32] iter = 0160, loss = 0.3618
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:18:51] iter = 0170, loss = 0.2436
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:19:11] iter = 0180, loss = 0.3841
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:19:30] iter = 0190, loss = 0.5887
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:19:50] iter = 0200, loss = 0.2460
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:20:09] iter = 0210, loss = 0.2795
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:20:29] iter = 0220, loss = 0.4486
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:20:48] iter = 0230, loss = 0.4698
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:21:08] iter = 0240, loss = 0.5301
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:21:27] iter = 0250, loss = 0.3800
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:21:47] iter = 0260, loss = 0.4949
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:22:06] iter = 0270, loss = 0.2912
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:22:26] iter = 0280, loss = 0.3707
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:22:46] iter = 0290, loss = 0.5719
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:23:05] iter = 0300, loss = 0.3220
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:23:26] iter = 0310, loss = 0.2515
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:23:46] iter = 0320, loss = 0.4499
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:24:05] iter = 0330, loss = 0.3418
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:24:25] iter = 0340, loss = 0.4156
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:24:44] iter = 0350, loss = 0.3612
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:25:04] iter = 0360, loss = 0.2732
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:25:24] iter = 0370, loss = 0.4645
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:25:43] iter = 0380, loss = 0.3310
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:26:03] iter = 0390, loss = 0.5321
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:26:22] iter = 0400, loss = 0.2634
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:26:42] iter = 0410, loss = 0.3410
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:27:01] iter = 0420, loss = 0.4026
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:27:21] iter = 0430, loss = 0.3307
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:27:40] iter = 0440, loss = 0.2624
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:28:00] iter = 0450, loss = 0.4038
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:28:19] iter = 0460, loss = 0.3856
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:28:39] iter = 0470, loss = 0.2591
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:28:58] iter = 0480, loss = 0.4565
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:29:17] iter = 0490, loss = 0.3057
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DSA augmentation strategy:
 color_crop_cutout_flip_scale_rotate
DSA augmentation parameters:
 {'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'ratio_noise': 0.05, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'batchmode': False, 'latestseed': -1}
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1001/1001 [00:13<00:00, 75.06it/s]
[2024-11-04 11:29:48] Evaluate_00: epoch = 1000 train time = 13 s train loss = 0.053457 train acc = 0.0200, test acc = 0.9679
Evaluate 1 random ConvNet, mean = 0.9779 std = 0.0000
-------------------------
Device: cuda
[2024-11-04 11:29:51] iter = 0500, loss = 0.2452
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:30:10] iter = 0510, loss = 0.2186
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:30:30] iter = 0520, loss = 0.3689
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:30:49] iter = 0530, loss = 0.4163
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:31:09] iter = 0540, loss = 0.3828
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:31:28] iter = 0550, loss = 0.3457
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:31:48] iter = 0560, loss = 0.6035
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:32:08] iter = 0570, loss = 0.4514
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:32:27] iter = 0580, loss = 0.2456
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:32:47] iter = 0590, loss = 0.5459
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:33:07] iter = 0600, loss = 0.4819
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:33:28] iter = 0610, loss = 0.3950
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:33:47] iter = 0620, loss = 0.4753
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:34:07] iter = 0630, loss = 0.2503
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:34:26] iter = 0640, loss = 0.2909
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:34:45] iter = 0650, loss = 0.2676
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:35:05] iter = 0660, loss = 0.5391
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:35:25] iter = 0670, loss = 0.2914
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:35:44] iter = 0680, loss = 0.2456
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:36:04] iter = 0690, loss = 0.2927
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:36:24] iter = 0700, loss = 0.4439
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:36:43] iter = 0710, loss = 0.3805
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:37:03] iter = 0720, loss = 0.3449
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:37:22] iter = 0730, loss = 0.2404
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:37:42] iter = 0740, loss = 0.4637
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:38:01] iter = 0750, loss = 0.3626
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:38:20] iter = 0760, loss = 0.5644
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:38:40] iter = 0770, loss = 0.4476
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:38:59] iter = 0780, loss = 0.4565
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:39:19] iter = 0790, loss = 0.6812
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:39:38] iter = 0800, loss = 0.3491
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:39:57] iter = 0810, loss = 0.3136
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:40:17] iter = 0820, loss = 0.4166
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:40:36] iter = 0830, loss = 0.2142
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:40:56] iter = 0840, loss = 0.2754
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:41:15] iter = 0850, loss = 0.3758
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:41:34] iter = 0860, loss = 0.3139
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:41:54] iter = 0870, loss = 0.3475
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:42:14] iter = 0880, loss = 0.2475
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:42:33] iter = 0890, loss = 0.5505
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:42:53] iter = 0900, loss = 0.3976
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:43:12] iter = 0910, loss = 0.2223
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:43:31] iter = 0920, loss = 0.2385
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:43:50] iter = 0930, loss = 0.2105
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:44:09] iter = 0940, loss = 0.3111
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:44:29] iter = 0950, loss = 0.2279
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:44:48] iter = 0960, loss = 0.3196
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:45:07] iter = 0970, loss = 0.3725
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:45:27] iter = 0980, loss = 0.4358
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:45:46] iter = 0990, loss = 0.4795
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DSA augmentation strategy:
 color_crop_cutout_flip_scale_rotate
DSA augmentation parameters:
 {'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'ratio_noise': 0.05, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'batchmode': False, 'latestseed': -1}
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1001/1001 [00:13<00:00, 75.33it/s]
[2024-11-04 11:46:16] Evaluate_00: epoch = 1000 train time = 13 s train loss = 0.048251 train acc = 0.0200, test acc = 0.9719
Evaluate 1 random ConvNet, mean = 0.9819 std = 0.0000
-------------------------
Device: cuda
[2024-11-04 11:46:19] iter = 1000, loss = 0.3866
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:46:39] iter = 1010, loss = 0.4768
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:46:58] iter = 1020, loss = 0.3699
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:47:18] iter = 1030, loss = 0.2455
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:47:37] iter = 1040, loss = 0.2349
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:47:57] iter = 1050, loss = 0.2830
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:48:16] iter = 1060, loss = 0.3401
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:48:36] iter = 1070, loss = 0.2984
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:48:55] iter = 1080, loss = 0.2427
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:49:15] iter = 1090, loss = 0.2659
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:49:34] iter = 1100, loss = 0.6998
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:49:53] iter = 1110, loss = 0.4237
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:50:13] iter = 1120, loss = 0.3945
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:50:32] iter = 1130, loss = 0.2654
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:50:52] iter = 1140, loss = 0.2200
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:51:11] iter = 1150, loss = 0.3299
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:51:31] iter = 1160, loss = 0.5023
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:51:50] iter = 1170, loss = 0.2648
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:52:10] iter = 1180, loss = 0.4200
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:52:29] iter = 1190, loss = 0.3853
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:52:48] iter = 1200, loss = 0.2465
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:53:08] iter = 1210, loss = 0.4026
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:53:28] iter = 1220, loss = 0.2418
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:53:47] iter = 1230, loss = 0.3020
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:54:07] iter = 1240, loss = 0.3745
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:54:26] iter = 1250, loss = 0.3570
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:54:45] iter = 1260, loss = 0.2723
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:55:05] iter = 1270, loss = 0.2628
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:55:24] iter = 1280, loss = 0.6722
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:55:44] iter = 1290, loss = 0.2415
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:56:03] iter = 1300, loss = 0.3683
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:56:23] iter = 1310, loss = 0.4255
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:56:42] iter = 1320, loss = 0.2097
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:57:02] iter = 1330, loss = 0.3111
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:57:21] iter = 1340, loss = 0.3794
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:57:41] iter = 1350, loss = 0.5460
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:58:00] iter = 1360, loss = 0.4890
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:58:20] iter = 1370, loss = 0.2277
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:58:39] iter = 1380, loss = 0.3172
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:58:59] iter = 1390, loss = 0.2467
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:59:18] iter = 1400, loss = 0.4993
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:59:38] iter = 1410, loss = 0.1926
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 11:59:57] iter = 1420, loss = 0.2257
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:00:17] iter = 1430, loss = 0.2766
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:00:36] iter = 1440, loss = 0.4324
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:00:56] iter = 1450, loss = 0.3243
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:01:15] iter = 1460, loss = 0.2199
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:01:35] iter = 1470, loss = 0.3606
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:01:54] iter = 1480, loss = 0.1856
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:02:14] iter = 1490, loss = 0.2937
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1500
DSA augmentation strategy:
 color_crop_cutout_flip_scale_rotate
DSA augmentation parameters:
 {'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'ratio_noise': 0.05, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'batchmode': False, 'latestseed': -1}
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1001/1001 [00:13<00:00, 73.87it/s]
[2024-11-04 12:02:45] Evaluate_00: epoch = 1000 train time = 13 s train loss = 0.045625 train acc = 0.0200, test acc = 0.9690
Evaluate 1 random ConvNet, mean = 0.9790 std = 0.0000
-------------------------
[2024-11-04 12:02:47] iter = 1500, loss = 0.6773
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:03:06] iter = 1510, loss = 0.3532
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:03:26] iter = 1520, loss = 0.2028
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:03:46] iter = 1530, loss = 0.5087
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:04:05] iter = 1540, loss = 0.3069
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:04:24] iter = 1550, loss = 0.3098
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:04:44] iter = 1560, loss = 0.2459
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:05:03] iter = 1570, loss = 0.1862
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:05:23] iter = 1580, loss = 0.3065
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:05:42] iter = 1590, loss = 0.3073
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:06:01] iter = 1600, loss = 0.2344
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:06:21] iter = 1610, loss = 0.4428
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:06:41] iter = 1620, loss = 0.2423
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:07:00] iter = 1630, loss = 0.4810
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:07:20] iter = 1640, loss = 0.3807
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:07:39] iter = 1650, loss = 0.2228
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:07:59] iter = 1660, loss = 0.2387
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:08:18] iter = 1670, loss = 0.3145
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:08:38] iter = 1680, loss = 0.4078
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:08:57] iter = 1690, loss = 0.2800
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:09:17] iter = 1700, loss = 0.1821
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:09:36] iter = 1710, loss = 0.2538
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:09:56] iter = 1720, loss = 0.3146
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:10:16] iter = 1730, loss = 0.3464
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:10:35] iter = 1740, loss = 0.2250
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:10:55] iter = 1750, loss = 0.5080
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:11:14] iter = 1760, loss = 0.3881
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:11:34] iter = 1770, loss = 0.2223
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:11:53] iter = 1780, loss = 0.2722
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:12:12] iter = 1790, loss = 0.2785
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:12:32] iter = 1800, loss = 0.4815
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:12:51] iter = 1810, loss = 0.3641
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:13:11] iter = 1820, loss = 0.1997
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:13:30] iter = 1830, loss = 0.4874
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:13:50] iter = 1840, loss = 0.3907
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:14:10] iter = 1850, loss = 0.2432
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:14:29] iter = 1860, loss = 0.1903
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:14:49] iter = 1870, loss = 0.2555
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:15:08] iter = 1880, loss = 0.2356
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:15:28] iter = 1890, loss = 0.2347
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:15:47] iter = 1900, loss = 0.2223
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:16:07] iter = 1910, loss = 0.3241
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:16:27] iter = 1920, loss = 0.2991
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:16:46] iter = 1930, loss = 0.1883
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:17:06] iter = 1940, loss = 0.2104
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:17:25] iter = 1950, loss = 0.2535
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:17:44] iter = 1960, loss = 0.2292
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:18:03] iter = 1970, loss = 0.2573
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:18:22] iter = 1980, loss = 0.2375
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
[2024-11-04 12:18:41] iter = 1990, loss = 0.2432
loading file ../buffer_storage/MNIST/ConvNet/replay_buffer_0.pt
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 2000
DSA augmentation strategy:
 color_crop_cutout_flip_scale_rotate
DSA augmentation parameters:
 {'aug_mode': 'S', 'prob_flip': 0.5, 'ratio_scale': 1.2, 'ratio_rotate': 15.0, 'ratio_crop_pad': 0.125, 'ratio_cutout': 0.5, 'ratio_noise': 0.05, 'brightness': 1.0, 'saturation': 2.0, 'contrast': 0.5, 'batchmode': False, 'latestseed': -1}
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1001/1001 [00:13<00:00, 75.68it/s]
[2024-11-04 12:19:11] Evaluate_00: epoch = 1000 train time = 13 s train loss = 0.036614 train acc = 0.0200, test acc = 0.9707
Evaluate 1 random ConvNet, mean = 0.9807 std = 0.0000
-------------------------
Device: cuda
[2024-11-04 12:19:13] iter = 2000, loss = 0.2249
